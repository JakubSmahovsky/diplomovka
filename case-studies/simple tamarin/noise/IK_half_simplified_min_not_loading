// notation: 
// key XYZ; X: Static/Ephemeral, Y: Secret/Public, Z: Alice/Bob
principals: Alice, Bob

Bob [
  knows private SSB
  distributed SPB = 'g'^SSB
]

Alice [
  generates payload
  knows private SSA
  SPA = 'g'^SSA
  knows public SPB
  generates ESA
  EPA = 'g'^ESA
  
  DHes = SPB^ESA
  DHss = SPB^SSA
  M = ENC({DHes, DHss}, payload)
]
Alice -> Bob: EPA, SPA, M

Bob [
  DHes = EPA^SSB
  DHss = SPA^SSB
  payload = DEC({DHes, DHss}, M)
]