principals: Alice, Bob

Alice [
  knows private Kab
  generates Na
  m1 = ENC(Kab, Na)
]
Alice -> Bob: Alice, m1

Bob [
  knows private Kab
  Na = DEC(Kab, m1)

  succNa = HASH(Na)
  generates Nb
  m2 = ENC(Kab, {succNa, Nb})
]
Bob -> Alice: m2

Alice [
  {succNa, Nb} = DEC(Kab, m2)
  ASSERT(succNa, HASH(Na))?

  succNb = HASH(Nb)
  m3 = ENC(Kab, succNb)
]
Alice -> Bob: m3

Bob [
  succNb = DEC(Kab, m3)
  ASSERT(succNb, HASH(Nb))?

  generates Kab2, Nb2
  m4 = ENC(Kab, {Kab2, Nb2})
]
Bob -> Alice: m4

Alice [
  {Kab2, Nb2} = DEC(Kab, m4)
]

queries [
  confidentiality? Alice's Kab2
]
