/* I'm trying to find out if the public identities
used in one run of the protocol can be reused inverted.
They can.*/

theory Invert_Principals
begin

rule Init:
  [ Fr(~Nonce) ]-->
  [ !Alice_0($A, $B, ~Nonce)
  , !Bob_0($A, $B, ~Nonce) ]

rule Alice:
  [ !Alice_0($A, $B, Nonce)]
  --[Alice($A, $B, Nonce)]->[]


rule Bob:
  [ !Bob_0($A, $B, Nonce)]
  --[Bob($A, $B, Nonce)]->[]

lemma invertible:
  exists-trace
    "Ex A B N1 N2 #i1 #i2 #i3 #i4 .
    Alice(A, B, N1) @#i1 &
    Alice(B, A, N2) @#i2 &
    Bob(A, B, N1) @#i3 &
    Bob(B, A, N2) @#i4
    "
end