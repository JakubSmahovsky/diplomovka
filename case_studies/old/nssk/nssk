principals: Alice, Bob, Server

Alice [
  knows public Bob
  knows private Kas
]

Bob [
  knows public Alice
  knows private Kbs
]

Server [
  knows public Alice, Bob
  knows private Kas, Kbs
]

Alice [
  generates Na
]
Alice -> Server: Alice, Bob, Na

Server [
  generates Kab
  ma = ENC(Kas, {Na, Bob, Kab, ENC(Kbs, {Kab, Alice})})
]
Server -> Alice: ma

Alice [
  {Na, Bob, Kab, mb} = DEC(Kas, ma)
]
Alice -> Bob: mb

Bob [
  {Kab, Alice} = DEC(Kbs, mb)
  generates Nb
  ch = ENC(Kab, Nb)
]
Bob -> Alice: ch

Alice [
  Nb = DEC(Kab, ch)
  re = ENC(Kab, {Nb, '1'})
]
Alice -> Bob: re

Bob [
  {Nb, '1'} = DEC(Kab, re)
]

Alice -> Alice: Kab

queries [
  injective-authentication? Alice -> Bob: re
]